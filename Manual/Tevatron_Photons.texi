@node Tevatron_Photons
@section Tevatron_Photons

@menu
* Single photon production::
* Diphoton production::
@end menu


We have studied prompt photon production in @mycite{Hoeche2009xc} and this
section serves as a practical guide to the features necessary for these
studies. Its main emphasis lies on how to generate samples which include
both the direct and fragmentation component and how to apply ME+PS merging.

Traditionally, the direct and fragmentation component are well separated
in a parton-shower Monte-Carlo, e.g. for single photon production: The
direct component is produced by using the 2->2 matrix element with
a photon and a parton in the final state, and the fragmentation component
can be generated by using the 2->2 matrix element with two partons in the
final state. On top of the LO matrix elements the parton shower would then
produce interleaved QCD+QED emissions, where the QED shower emissions from
the dijet sample will create the fragmentation component.

Note, that the generation of the fragmentation component in this way is very
inefficient, because the shower will only very rarely produce hard isolated
photons. To be able to compare to this method at all in @mycite{Hoeche2009xc},
we have implemented an enhancement of the QED splitting functions in the
parton shower which is of course corrected for by giving the events appropriate
weights, cf. the appendix of that paper.

But the main feature of @mycite{Hoeche2009xc} is the consistent treatment of
photons in the context of ME+PS merging. This effectively means that one
can split the fragmentation component into two parts by phase space slicing.
Hard isolated photons are produced from the exact higher-order tree-level
matrix element (e.g. pp -> photon + 2, 3, ... partons) while collinear photons
are produced by the parton-shower, taking into account the correct resummation
of the quark-photon singularities.

This is not only advisable to become less dependent on uncertain parton-shower
approximations in the non-collinear region, but will also help to generate
the fragmentation component more efficiently: If the phase space slicing
criterion in the ME+PS merging is sufficiently similar (or loose) compared to
the photon isolation criterion used in the analysis, one can expect that the
second, painful, part of the fragmentation component, i.e. the one from the
parton shower, becomes irrelevant for the analysis.

So in the following we describe how to generate single photons and
diphotons making use of the default photon slicing criterion which looks
like:

@code{$\min(p_\perp^2(\gamma), p_\perp^2(parton)) (\DeltaR(\gamma, parton)/D)^2 > Q^2_cut$}

where @code{D=0.3} by default and @code{Q_cut} is the merging parameter
specified in the CKKW line of the processes section. It might be sufficient to
adapt these two parameters, e.g. in the following run cards set
@example
  CKKW sqr(10.0/E_CMS)|0.2
@end example
for @code{Q_cut=10.0} and @code{D=0.2}.
If you notice that your photon isolation criterion is not sufficiently similar
(the shower sample does contribute to your analysis) one might have to manually
adapt the slicing criterion in Sherpa. Please contact us for assistance in that
case.

Also note, that these run cards will generate weighted events with
ME enhancements in phase space regions which would otherwise not be filled
very efficiently.

@node Single photon production
@subsection Single photon production

@subsubsection Photons from ME
@example
@smallformat
@verbatiminclude Examples/Tevatron_Photons/Run.single.me.dat
@end smallformat
@end example

@itemize @bullet
@item In the @code{processes} section, matrix elements for
      pp(bar) -> photon + 1, 2, 3 partons are requested.
      Only Feynman diagrams with exactly one electroweak coupling are allowed.
      
      The merging criterion is set to @code{Q_cut=10.0 GeV}.

      @code{Enhance_Function}'s (cf. @ref{Enhance_Function}) are introduced
      to produce more hard partons/photons than the steeply falling cross
      section would imply (appropriately weighted).
@item The @code{selector} section allows to specify phase space cuts on the
      matrix element level, cf. @ref{Selectors}. Here we demand two jets
      with pT > 10.0 GeV.
@item Electro-weak splitting functions in the shower are activated in
      the @code{shower} section.
@item The @code{me} section enables weighted event generation and switches
      off the emission of additional soft photons from the hard scattering.
@item The steeply rising enhance functions necessitate a redefinition 
      of the integration error target, see @ref{Enhance_Function}. 
      The new value is set globally in the @code{integration} section.
@item To generate only prompt photons, the hadronisation, hadron decays and
      underlying event are turned off. These steps of the simulation can be 
      enabled as described in @ref{Hadronization parameters} and
      @ref{MI_HANDLER}.
@item The @code{beam} section specifies Tevatron Run 2 conditions in this
      example but can simply be changed.
@end itemize

@subsubsection Photons from Shower

(which will ideally be irrelevant for the analysis)

@example
@smallformat
@verbatiminclude Examples/Tevatron_Photons/Run.single.ps.dat
@end smallformat
@end example

Here only the differences with respect to above are explained:
@itemize @bullet
@item In the @code{processes} section, matrix elements for
      pp(bar) -> dijet + 0, 1, 2 partons are requested.
      Only Feynman diagrams without electroweak couplings are allowed
      (for efficiency reasons).
@end itemize


@node Diphoton production
@subsection Diphoton production

@subsubsection Photons from ME
@example
@smallformat
@verbatiminclude Examples/Tevatron_Photons/Run.diphoton.me.dat
@end smallformat
@end example

Here only the differences with respect to the single photon example are
explained:
@itemize @bullet
@item In the @code{processes} section, tree-level matrix elements for
      pp(bar) -> photon photon + 0, 1, 2 partons are requested.
      Only Feynman diagrams with exactly two electroweak couplings are allowed
      (for efficiency reasons).
      
      In addition, the loop-induced matrix element for the process
      gg -> photon photon is enabled.
@end itemize

@subsubsection Photons from Shower

(which will ideally be irrelevant for the analysis)

The shower can produce di-photon events either from single-photon
events or from di-jet events by producing one or two photons respectively.
Here these two contributions are generated in one run, but of course they
could be separated as well.

@example
@smallformat
@verbatiminclude Examples/Tevatron_Photons/Run.diphoton.ps.dat
@end smallformat
@end example

Here only the differences with respect to above are explained:
@itemize @bullet
@item In the @code{processes} section, matrix elements for
      pp(bar) -> dijet + 0, 1, 2 partons and
      pp(bar) -> photon + 1, 2, 3 partons are requested.
      Only Feynman diagrams with 0 or 1 electroweak couplings respectively
      are allowed (for efficiency reasons).
@end itemize

@subsection Patch for NJetFinder

Unfortunately we realised too late that one minor change that allows event
generation in the way described above did not make it into release 1.2.1. To
use the NJetFinder in a context of democratic partons/photons you will have
to download 
@uref{http://projects.hepforge.org/sherpa/dokuwiki/_media/downloads/version-1.2/njetfinder.patch,,this patch}
and apply it to the 1.2.1 source code as follows:
@example
cd SHERPA-MC-1.2.1
patch -p0 < njetfinder.patch
make install
@end example
